<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.pcwk.ctrl.review">
    
    <insert id="doReviewInsert" parameterType="ReviewVO">
        INSERT INTO review (  
                    r_num,    
                    d_num,    
                    o_num,    
                    r_content,
                    o_name,   
                    r_dt      
        ) VALUES (            
            REVIEW_S.NEXTVAL, 
            #{dNum},                
            #{oNum},                
            #{rContent},                
            #{oName},                
            SYSDATE           
        )                     
       
    </insert>
    <select id="getCount" parameterType="ReviewVO" resultType="int">
        SELECT COUNT(*) AS cnt    
        FROM review            
        WHERE r_num LIKE #{rNum}  || '%' 
    </select>   
    
    <resultMap type="ReviewVO" id="reviewResultMap">
        <id property="rNum" column="r_num"/>
        <result property="dNum" column="d_num"/>
        <result property="oNum" column="o_num"/>
        <result property="rContent" column="r_content"/>
        <result property="oName" column="o_name"/>
        <result property="rDt" column="r_dt"/>
    </resultMap>    
    
    <select id="doSelectOne" parameterType="ReviewVO" resultMap="reviewResultMap">
       <![CDATA[ 
        SELECT  r_num,    
                d_num,    
                o_num,    
                r_content,
                o_name,   
                r_dt   
        FROM review 
        WHERE r_num = #{rNum}
        ]]>
    </select>      
</mapper>